{% extends 'library/base.html' %}
{% block title %}{{ book.title }}{% endblock %}

{% block content %}
<div class="card shadow-sm mb-4 card-hover">
    <div class="card-body">
        <h3>{{ book.title }}</h3>
        <p class="text-muted mb-2">Uploaded by: {{ book.uploaded_by.username }}</p>
        <p>{{ book.description }}</p>

        <div class="mt-3 d-flex flex-wrap gap-2">
            {% if user in book.users_who_like.all %}
            <a href="{% url 'unfavorite_book' book.id %}" class="btn btn-warning btn-sm btn-hover">Unfavorite</a>
            {% else %}
            <a href="{% url 'favorite_book' book.id %}" class="btn btn-primary btn-sm btn-hover">Add to Favorites</a>
            {% endif %}

            {% if book.uploaded_by == user %}
            <a href="{% url 'edit_book' book.id %}" class="btn btn-secondary btn-sm btn-hover">Edit</a>
            <a href="{% url 'delete_book' book.id %}" class="btn btn-danger btn-sm btn-hover">Delete</a>
            {% endif %}
        </div>
    </div>
</div>

<h5>Users who favorited this book:</h5>
<ul class="list-group mb-4">
    {% for u in book.users_who_like.all %}
    <li class="list-group-item">{{ u.username }}</li>
    {% empty %}
    <li class="list-group-item">No one has favorited this book yet.</li>
    {% endfor %}
</ul>
{% endblock %}